apiVersion: v1
data:
  bootstrap-cloud-v2.properties: |
      spring.profiles.active=jx-staging,development
      kubernetes.namespace=jx-staging
      environment.type=development
      environment.release=${version:0.0.1}
      spring.cloud.vault.uri=https://vault.jx-vault:8200
      spring.cloud.vault.authentication=KUBERNETES
      spring.cloud.vault.kubernetes.role=${spring.application.name}-${kubernetes.namespace}
      spring.cloud.vault.generic.enabled=false
      spring.cloud.vault.kv.backend=secret
      spring.cloud.vault.kv.enabled=true
      spring.cloud.vault.kv.default-context=${kubernetes.namespace}
      spring.cloud.vault.kv.application-name=${spring.application.name}
      spring.cloud.vault.kv.profiles=${spring.profiles.active}
      spring.cloud.vault.enabled=true
      spring.cloud.kubernetes.enabled=true
      spring.cloud.kubernetes.config.enabled=true
      spring.cloud.kubernetes.config.sources[1].name=${spring.application.name}
      spring.cloud.kubernetes.config.sources[0].name=ms-common-properties
      #logging.config=/spring/cloud/logback.xml
      logging.level.org.springframework.vault.core=WARN
      logging.level.p6spy=WARN
  logback.xml: |
    <configuration>
      <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
          <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder">
              <providers>
                  <timestamp/>
                  <message/>
                  <loggerName/>
                  <threadName/>
                  <logLevel/>
                  <mdc/>
                  <throwableClassName/>
                  <stackTrace>
                      <throwableConverter class="net.logstash.logback.stacktrace.ShortenedThrowableConverter">
                          <maxLength>1024</maxLength>
                      </throwableConverter>
                  </stackTrace>
                  <throwableRootCauseClassName/>
                  <rootStackTraceElement/>
                  <callerData/>
              </providers>
          </encoder>
      </appender>

      <root level="INFO">
          <appender-ref ref="STDOUT" />
      </root>
    </configuration>
kind: ConfigMap
metadata:
  name: ms-cloud-bootstrap

